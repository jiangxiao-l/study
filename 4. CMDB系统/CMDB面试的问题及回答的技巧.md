# CMDB面试问题及回答的技巧

```python
# 问题一：你们公司为什么要开发一套CMBD系统：
 
回答： 恩.. 是这样的，前期我们公司在服务器数据收集这方面，主要是人为的去收集并记录在excel表格中的，但是呢，有些工作人员的职业素养不是特别高，没有按照我们规定的去记录数据。等到公司年度审计数据的时候，发现有好多的数据丢不能用了。所以，公司决定自己开发一套能够自动化获取，并记录服务器信息的这样一套系统


# 问题二：你们公司在前期调研的时候，有哪些方案？
 
回答： 我们经过差不多两个月的调研，一共总结了3套方案。 
      第一套方案就是agent。就比如说，这些都是一台台服务器，在每台服务器上都需要部署上agent脚本。agent脚本是用Python中的subprocess模块写的，他可以定期的执行一些系统命令，然后将这些数据，通过request模块，发送到另一台服务器上，我们将这台服务器叫做PAI,然后再通过API将数据保存到数据库(DB)中，还有一个前端展示页面，提供给管理员使用。。en...这种方案的一个优点就是速度快，但是呢，他也有一个缺点，也是我们最终没有选择这种方案的原因,就是在每增加一台服务器，就要部署一下agent脚本。而这项工作也是比较繁琐的。
      第二套方案。。第二套方案相对于第一套方案来说，他在PAL和服务器之间增加了一台服务器，我们把它叫做中控机。。我们在这台中控机上安装上paramiko这个模块。这个模块也是通过python写的。它的作用也xshell类似。在得知服务器的IP地址和主机名的情况下，我们可以通过这台中控机登入到每一台服务器上，然后这时候就可以执行服务器上的一些系统命令，从而得到数据。然后同样的我们可以通过request模块，将得到的数据传递给API,然后通过API将数据保存到数据库中。。。。这种方案的好处就是，我们不需要在每一台的服务器上部署agent脚本，极大地减轻了人力物力。。。可是，我们在测试的时候发现，，他比较依赖于与网络，随着服务器的不断增加，在速度方面表现的不是特别好。所以我们最终也是没有采取  这种方案。。
      第三种方案相对于第二种方案有点相似，他也是由一个中控机，还有API，数据库，页面展示，还有服务器组成。。那这种方案，是在中控机上，安装一个salt-master，这么一个软件，在服务器上安装一个salt-minion 软件。。再通过一些配置和授权之后，在中控机上是可以通过发送命令让服务器去执行的。，而后服务器会将数据返回给中控机上。。然后同样的道理，通过request模块，将数据保存到数据库中。他最大的优点就是使用现成软件，不要在人为的去编写一些代码，就能够实现。。我们最终采取的是这种方案。。。主要的原因是我们发现我们的服务器上碰巧就已经安装好了这么一个软件。。。所以，我们最终选择了这中方案。
      
      
 # 问题三：你在这个项目中负责哪一块？
 
 回答：恩...这个项目，公司后来主要是让我来负责。。一方面是想进一步的观察我的能力，另一方面也       是信任我。。。那么我在负责整个项目的同时，也主要负责收据收集这一块。。。
 
# 问题四：你在开发中遇到了哪些问题，这些问题后来是怎么解决的？
 
回答：恩...当时遇到的问题主要有三个。。第一个，就是当代码快要写完的时候，发现自己写的代码，功能单一，可扩展性也比较差，后来也是花了比较多的时间，去网上查各种资料，最终参考django框架的部分代码，实现了项目的可插拔性。。什么是可插拔性呢？？ 就比如现在，你想收集服务器上面的cpu的信息，你只要在配置文件上添加一条数据，就可以实现，那么，当你不想要收集这个数据了，你就可以在配置文件上删掉。同时，也实现了项目的多功能性。。虽然，我们公司使用的是saltstack这种方案，但是我们的项目同时可以实现以上三种方案的自由切换，也是一样的，，是要在配置文件上配置一下，就可以了。。。后来，我们又遇到了一个问题，那就是唯一性标识的问题。唯一性标识就是，用一个标识去唯一的表示一台服务器。。。当时我们一开始用了SN来处理。。但是，后来在数据采集的时候，发现数据总是有丢失的现象。。。当时，我们公司在一些配置比较高的服务器上又装了几个虚拟机。。后来发现，虚拟机上面的SN和实体机上面的SN是相同的。。。后来，我们使用了主机名来做唯一的标识。。但是，这种方案也是存在某些问题的。。。就比如当主机名被改了以后数据怎么处理，。。。后来我们规定，在已经记录到数据库的服务器的主机名最好是不能修改，即使是修改了，也要及时的修改回来。。。但是，这种规定也是存在一些局限性。。当然，我们也是采取了一些措施，在第一次记服务器信息的时候，就将服务器的主机名事先保存起来。。。然后每次保存数据的时候就用根据第一个主机名来进行数据的更新。还有一个最麻烦的问题还是在业务上的问题，因为我们公司的部门比较多，提出的要求也比较多。

# API的验证：
    时间的规定，token,token存放到redis中，设置过期时间。

```

