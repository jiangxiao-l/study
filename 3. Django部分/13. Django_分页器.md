# Django_分页器

## 一、批量创建数据

```
--- objects.bulk_create

def index(request):
    li = []
    for i in range(100):
        li.append(Book(name='图书%s' % i, price=i + 10))
    # 实现批量插入数据
    Book.objects.bulk_create(li)
    return HttpResponse('ok')
```



## 二、分页器的认识使用

```
1.  导入分页的模块：from django.core.paginator import Paginator

2.  # 实例化产生一个分页器的对象Paginator(),
    # 里面两个参数 object_list：book_list 的数据   per_page:另一个是每页显示的数据条数
      paginator = Paginator(book_list, 10)
      
3. 
    # 对象的内置方法
        # 1.数据的总条数
        # print(paginator.count)
        
        # 2. 分的页的总数
        # print(paginator.num_pages)
        
        # 3. 页码数的列表
        # print(paginator.page_range)
        
        # 4.取到第x页，返回一个page的对象，循环current_page也可以得到该页面的数据        		   
        # current_page = paginator.page(5)
        
        # 5.当前页码内的所有的数据
        # print(current_page.object_list)
        
        # 6.判断当前页面是否有上一页
        # print(current_page.has_previous())
        
        # 7.判断当前页面是否有下一个
        # print(current_page.has_next())
        
        # 8. 上一页的页码数
        # print(current_page.previous_page_number())
        
        # 下一页的页码
        # print(current_page.next_page_number())

```

## 三、简单的分页器

```python
---后端的代码：
from django.core.paginator import Paginator
 def page(request):
        //得到所有的数据
        book_list = Book.objects.all()
        // 实例化产生Paginator对象
        paginator = Paginator(book_list,10)
        try:
            // 当前的页码数(从前台传过来)
            current_page_num = request.GET.get('page')
            // 循环current_page 可以得到当前页面的数据
            current_page =paginator.page(current_page_num) 
        except Exception as e:
            //如果抛出异常的话，就是页面显示第一张的数据
             current_page_num = 1 
             current_page =paginator.page(current_page_num) 
         return render(request,'book.html',local())
    
   
--前端的代码：book.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    {#    <link href="/static/js/bootstrap-3.3.7-dist/css/bootstrap.css">#}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <title>Title</title>
</head>
<body>
<div class="row">
    <div class="col-md-6 col-md-offset-3">

        <table class="table table-striped">
            <thead>
            <tr>
                <th>书名</th>
                <th>价格</th>
            </tr>
            </thead>
            <tbody>
            {% for book in current_page %}
                <tr>
                    <td>{{ book.name }}</td>
                    <td>{{ book.price }}</td>
                </tr>
            {% endfor %}

            </tbody>
        </table>
        <nav aria-label="Page navigation">
            <ul class="pagination">
                {# 上一页事件#}
                {% if current_page.has_previous %}
                    <li>
                        <a href="/page/?page={{ current_page.previous_page_number }}" aria-label="Previous">
                            <span aria-hidden="true">上一页</span>
                        </a>
                    </li>
                {% else %}
                    <li class="disabled">
                        <a href="" aria-label="Previous">
                            <span aria-hidden="true">上一页</span>
                        </a>
                    </li>
                {% endif %}


                    {# 实现点击点击按钮事件#}
                {% for foo in paginator.page_range %}
                    {% if currten_page_num == foo %}
                        <li class="active"><a href="/page/?page={{ foo }}">{{ foo }}</a></li>
                    {% else %}
                        <li><a href="/page/?page={{ foo }}">{{ foo }}</a></li>
                    {% endif %}

                {% endfor %}

                 {#下一页事件#}

                {% if current_page.has_next %}
                    <li>
                        <a href="/page/?page={{ current_page.next_page_number }}" aria-                          label="Next">
                            <span aria-hidden="true">下一页</span>
                        </a>
                    </li>
                {% else %}
                    <li class="disabled">
                        <a href="" aria-label="Next">
                            <span aria-hidden="true">下一页</span>
                        </a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>

</div>
</body>
</html>

```

## 四、最终版的分页器

```
---后端的代码：
def page_next(request):
	//数据的准备
    book_list = Book.objects.all()
    paginator = Paginator(book_list, 5)
    # 如果页码数多的话，让他显示前5，后5，中间是当前在的页码
    try:
        # 当前的页面
        current_page_num = int(request.GET.get('page'))
        #取到第x页面的，返回一个对象，循环此对象也可以得到当前页面的数据
        current_page = paginator.page(current_page_num)
    except Exception as e:
        current_page_num = 1
        current_page = paginator.page(current_page_num)
    # 总页码数，大于11的时候
    if paginator.num_pages > 11:
            # 当前页码数在 -5大于1的时候，显示最开始的11个数据
        if current_page_num - 5 < 1:
             page_range = range(1, 12)

         elif current_page_num + 5 > paginator.num_pages:
                # 当前的页码数+5大于总页码数，往前推11个 ，显示最后面的11个数据
               page_range = range(paginator.num_pages - 10, paginator.num_pages + 1)
         else:
                page_range = range(current_page_num - 5, current_page_num + 6)
     else:
            # 小于11的时候，有多页显示多少页
            page_range = paginator.page_range
    return render(request, 'book_next.html', locals())
    
    
   ---前端的代码：book_next.html 
   <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <title>Title</title>
</head>
<body>
<div class="row">
    <div class="col-md-6 col-md-offset-3">
        <table class="table table-striped">
            <thead>
            {% for book  in current_page %}
                <tr>
                    <td>{{ book.name }}</td>
                    <td>{{ book.price }}</td>
                </tr>
            {% endfor %}

            </thead>
        </table>

        <nav aria-label="Page navigation">
            <ul class="pagination">
                {% if current_page.has_previous %}
                    <li>
                        <a href="/text/?page={{ current_page.previous_page_number }}" aria-label="Previous">
                            <span aria-hidden="true">上一页</span>
                        </a>
                    </li>
                {% else %}
                    <li class="disabled">
                        <a href="" aria-label="Previous">
                            <span aria-hidden="true">上一页</span>
                        </a>
                    </li>
                {% endif %}

                {% for foo in page_range %}
                    {% if currten_page_num == foo %}
                        <li class="active"><a href="/text/?page={{ foo }}">{{ foo }}</a></li>
                    {% else %}
                        <li><a href="/text/?page={{ foo }}">{{ foo }}</a></li>
                    {% endif %}
                {% endfor %}
                {% if current_page.has_next %}
                    <li>
                        <a href="/text/?page={{ current_page.next_page_number }}" aria-label="Next">
                            <span aria-hidden="true">下一页</span>
                        </a>
                    </li>
                {% else %}
                    <li class="disabled">
                        <a href="" aria-label="Next">
                            <span aria-hidden="true">下一页</span>
                        </a>
                    </li>
                {% endif %}

            </ul>
        </nav>
    </div>

</div>
</body>
</html>
   

 
```

