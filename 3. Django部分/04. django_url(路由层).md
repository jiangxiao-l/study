django_url(路由层)

## 一、 简单的配置

```
-- url：是一个函数
--第一个的参数是正则表达式(如果要精确匹配的话，^publish/$)
--第二个参数时视图函数(不要加括号)
--第三参数可以是 name=‘pub’，为反向解析所提供
```

## 二、APPEND_SLASH

```python
-- 是否开启URL访问地址后面不为/跳转至带有/的路径的配置项
   APPEND_SLASH=True
  
from django.conf.urls import url
from app01 import views
        urlpatterns = [
                url(r'^blog/$', views.blog),
              ]  
 
 -- 访问 http://www.example.com/blog 时，默认将网址自动转换为 http://www.example.com/blog/ 
 
 -- 如果在settings.py中设置了 APPEND_SLASH=False，此时我们再请求 http://www.example.com/blog 时就会提示找不到页面。
```

## 三、无名分组

```
-- 例如在url中：r’ ^publishadd/([0-9]{4})/([0-9]{2}/$)’ 类似的写法

-- 分组后(就是括号内的内容)会把分组出来的数据，以位置参数的形式，传递给视
   图函数，所以视图函数一定要设置一个形参来接收 
   
--  def publish(request,*args): 视图函数可以这样接收

```

## 四、有名分组

```python
---在Python 正则表达式中，命名正则表达式组的语法是(?P<name>pattern)，其中name 是组的名称，pattern 是要匹配的模式。

---urlpatterns = [
        url(r'^articles/(?P<year>[0-9]{4})/$', views.year_archive),
        url(r'^articles/(?P<year>[0-9]{4})/(?P<month>[0-9]{2})/$',                		        views.month_archive),
        url(r'^articles/(?P<year>[0-9]{4})/(?P<month>[0-9]{2})/(?P<day>[0-9]{2})/$',         	   views.article_detail),
     ]
     
     注： 捕获到的数据都是str类型；  视图函数里可以指定默认值
         捕获的值作为关键字参数传递给视图函数
     
     url('blog/?(?P<num>[0-9]{1})', views.blog),
     
     def blog(request,num=1):
            print(num)
            return HttpResponse('ok')

```

## 五、反向解析

```
--在使用Django 项目时，一个常见的需求是获得URL 的最终形式，以用于嵌入到生成的内容中（视图中和显示给用户的URL等）或者用于处理服务器端的导航（重定向等）。人们强烈希望不要硬编码这些URL（费力、不可扩展且容易产生错误）或者设计一种与URLconf 毫不相关的专门的URL 生成机制，因为这样容易导致一定程度上产生过期的URL。


---视图函数重定向,或者模板中写死了路径
---可以用反向解析来动态生成路径
```

```python
--  先设定一个路由：
-1 无参数:url(r'^publishadd133/$', views.publishadd,name='ddd'),
-2 无名分组:url(r'^publishadd/([0-9]{4})/([0-9]{2})/$', views.publishadd,name='ddd'),
-3 有名分组:url(r'^publishadd/(?P<year>[0-9]{4})/(?P<mounth>[0-9]{2})/$', views.publishadd,name='ddd'),


--在视图函数层使用：
   -- 导入模快  from Django.conf.urls import severse
             --  无参数:url=reverse('ddd')
             
			 --  无名分组:url=reverse('ddd',args=(2018,12,))
			 
             --  有名分组:url=reverse('ddd',args=(2018,12,))
                         url=reverse('ddd',kwargs={'year':2018,'mounth':12})
             
 -- return redirect(url) //重定向到该页面上
 
 
 --在模板层使用：
   在模板层传输数据：
		 1. 无参数：{% url ‘ddd’ %}
		 
         2. 无名分组：{% url ‘ddd’ 2018 12 %}
         
         3. 有名分组：{% url ‘ddd’ 2018 12 %} 
                    {% url ‘ddd’ year= 2018 month= 12 % }        

```

## 六 、路由分发

```
-- 在不同的APP在创建urls.py

-- 在总路由
    -- 先导入一个模块:from django.conf.urls import include
    --  url(r'^blog/',include('blog.urls'))
    
-- 在不同的APP的urls里配置路由的关系

    **重点**总路由,不能加结束符$

```

## 七、名称空间

```python
 名称空间(是为了解决相同的名字的问题)
-url(r'^blog/',include('blog.urls',namespace='blog')),
-子路由:url(r'^publish/$', views.publish,name='test'),
	-反向解析:
		 -视图层:url = reverse('blog:test')
		 -模板层:{% url 'blog':test'%}
		      
***一般不要用***
      子路由:url(r'^publish/$', views.publish,name='app01_test'),

```

## 八、伪静态

```python
-- 将显示在页面上的数据看起来是的静态页面 --> 加上html 

-路由:url(r'^book/(?P<id>\d+.html)',views.book),
	  -访问:http://127.0.0.1:8000/book/4.html 
```

## 九、django2.0版的path

```python
1. re_path根url一样

2. path是准确路径：
		urlpatterns = [  
    path('articles/2003/', views.special_case_2003),  
    path('articles/<int:year>/', views.year_archive),  
    path('articles/<int:year>/<int:month>/', views.month_archive),  
    path('articles/<int:year>/<int:month>/<slug>/', views.article_detail),  
　　# path才支持，re_path不支持
　　path('order/<int:year>',views.order),
] 
         
3. 5个转换器:int,str,slug,path,uuid

    str,匹配除了路径分隔符（/）之外的非空字符串，这是默认的形式
    int,匹配正整数，包含0。
    slug,匹配字母、数字以及横杠、下划线组成的字符串。
    uuid,匹配格式化的uuid，如 075194d3-6885-417e-a8a8-6c931e272f00。
    path,匹配任何非空字符串，包含了路径分隔符（/）（不能用？）
    
4. 自定义转换器
	定义：
		class FourDigitYearConverter:  
                # 正则表达式：
                regex = '[0-9]{4}' 
                #函数：返回值
                def to_python(self, value):  
                    return int(value)  
                #函数：处理值
                def to_url(self, value):  
                    return '%04d' % value  
           
 注册：register_converter(converters.FourDigitYearConverter, 'yyyy') 

 使用：<yyy:year>
```

