# Django_单表操作

## 一、数据库的迁移

```
 --Python3 manage.py makemigrations  只是对变化做了一个记录，记录在文件APP的migrations
 
 -- python3 manae.py migrate         将更改好的提交到数据库中
 
 -- Python3 manage.py showmigrations  查看哪个没有提交到数据库中

```

## 二、数据的增加(create)

```
 方法一：model.Book.object 得到的是一个query的对象
       Book = model.Book.object.create(name=’jxl’,password=’123’ )
       
 方式二：model.Book 得到的是一book的对象
           Book = model.Book(name= ‘jxl’,password=’123’)
           Book.save()
```

## 三、数据的修改(update)

```
 方式一：
   Book=model.Book.object.filter(id=1).update(name = ‘jjj’)
   
  方式二：
	Book = model.Book.object.filter(name=’jjj’).First()
    Book.name = ‘ddd’
    Book.save()
```

## 四、数据的删除(delete)

```
方式一：
   Book= model.book.object.filter(id=1).delete
方式二：
 	Book = model.book.object.filter(id=1).first()
    Book.delete  
```

## 五、数据的查询

### 1.基于对象的查询

```
-all()
 Book = model.book.object.all()

--filter()
 Book =model.book.object.filter(id=1)

--get()

--exclude:取出除了红楼梦以外的书籍的信息
Book = model.book.objects.exclude(name=’红楼梦’)

--order_by: 排序 默认为升序  降序：加一个 “ -”
 Book = model.book.objects.order_by(“price”)  按照价格从高到低排序
 Book = model.book.objects.order_by(“-price”)  按照价格从低到高排序

--reverse：降序
  Book= model.book.objects.ordey_by(‘price’).reverse() 一般与order_by连用

--count: 查询的数量
 Book= model.book.objects.count()

-- exisit: 判断查询的数据是否存在 True | False
   Book= model.book.objects.filter(name = ‘jj’).exists()
    
-- values:一个对象套字典,可以设置显示的内容
   Book = model.book.objects.values(‘name’,’password’)

-- values_list:元祖 与values类似

--distanct: 去重 一般去重id的话，就没什么意义
   Book=model.book.object.values(‘name’,’price’).distance
```

### 2、基于双下划线的查询

```
__gt:大于 | __gte:大于等于 | __lt:小于 |  __lte:小于等于
    	book = models.Book.objects.filter(price__gt='100')
        book = models.Book.objects.filter(price__gte ='100') 
 
 __in: 在 [ ] 的里面:查询出价格为100 或则200 的数的信息
		Book=model.book.object.filter(price__in=[100,200])

  __range:在一定的范围内:查询出价格在100到200书籍的信息
		Book = model.book.objects.filter(price__range=[100,200])

  __contains:模糊查询，区分大小写 | icontent :不区分大小写
		Book = model.book.objects.filter(name__contanis=’红’)

  __starswith:判断以什么开头 |endswith:判断以什么结尾
       Book = model.book.objets.filter(name__sartswith =’西’)

  __year: 查询出出版时间为2018的书籍的信息
  	   Book = model.book.object.filter(create_year__year=’2018’)

```

### 3.相关练习

```
# 1 查询老男孩出版社出版过的价格大于200的书籍

# book = models.Book.objects.filter(publish ='老男孩出版社',price__gt =200)
# print(book)

# 2 查询2017年8月出版的所有以py开头的书籍名称
 book=models.Book.objects.filter(creat_data__year=2017,
                                 creat_data__month=8,
                                 name__startswith='Py')
# print(book)

# 3 查询价格为50,100或者150的所有书籍名称及其出版社名称
# book = models.Book.objects.filter(price__in=               [50,100,150]).values('name','publish__name')
# print(book)

# 4 查询价格在100到200之间的所有书籍名称及其价格
# book = models.Book.objects.filter(price__range=[100,200]).values('name','price')
# print(book)


# 5 查询所有人民出版社出版的书籍的价格（从高到低排序，去重）
#book=models.Book.objects.filter(publish='人出版社').values('price').order_by('-price').distinct()
# print(book)

# 6 查找所有书名里包含楼的书
# book = models.Book.objects.filter(name__contains='楼')
# print(book)

# 7 查找出版日期是2017年的书
# book = models.Book.objects.filter(creat_data__year=2017)
# print(book)

# 8 查找出版日期是2017年的书名
# book = models.Book.objects.filter(creat_data__year=2017).values("name")
# print(book)

# 9 查找价格大于10元的书
# book = models.Book.objects.filter(price__gt='10')
# print(book)

# 10 查找价格大于10元的书名和价格
# book = models.Book.objects.filter(price__gt='10').values('name','price')
# print(book)

```

